/* ==========================================
   1. GLOBAL VARIABLES & WINDOW
   ========================================== */
:root {
    --sla-bg-dark: #333e4d;
    --sla-bg-panel: #2a2a35;
    --sla-border: #1a1a25;
    --sla-text-light: #e0e0e0;
    --sla-accent: #39ff14;
    --sla-font-mono: "Roboto Condensed", "Arial Narrow", sans-serif;
}

.sla-sheet.window-content {
    background: var(--sla-bg-dark);
    color: var(--sla-text-light);
    font-family: var(--sla-font-mono);
    font-size: 13px;
    padding: 5px;
    overflow: hidden; 
    border: 2px solid #333;
}

.sla-sheet form {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow-y: auto; 
}

/* ==========================================
   2. INPUTS
   ========================================== */
.sla-sheet input[type="text"],
.sla-sheet input[type="number"],
.sla-sheet select {
    background: #d0d3d8; 
    border: 1px solid #555;
    border-radius: 0;
    color: #000;
    height: 24px;
    padding: 1px 5px;
    font-family: var(--sla-font-mono);
}

.sla-sheet input:focus {
    box-shadow: 0 0 5px var(--sla-accent);
    background: #fff;
}

.sla-sheet select {
    background-color: #000;
    color: #fff;
}

/* ==========================================
   3. HEADER & PORTRAIT (FIXED SIZE)
   ========================================== */
.sla-sheet .header-grid {
    display: grid;
    /* Name Area | Portrait | Finance Area */
    grid-template-columns: 1.5fr 140px 1fr; 
    gap: 10px;
    height: 200px; /* Locked height ensures image doesn't grow */
    margin-bottom: 10px;
}

.sla-sheet .profile-img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Crops image to fit the 140x200 box */
    border: 2px solid var(--sla-bg-panel);
    background: #fff;
}

/* Bio Section Layout */
.bio-section {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
}

.sla-sheet .bio-field {
    display: grid;
    grid-template-columns: 70px auto;
    align-items: center;
    background: #d0d3d8;
    padding-left: 5px;
    color: #000;
    font-weight: bold;
    margin-bottom: 2px;
}
.sla-sheet .bio-field label { font-size: 0.8em; }
.sla-sheet .bio-field input { border: none; background: transparent !important; }

/* Finance Section */
.sla-sheet .finance-box {
    background: var(--sla-bg-panel);
    padding: 5px;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}
.sla-sheet .finance-field label { display: block; color: #ccc; font-size: 0.8em; }
.sla-sheet .finance-field input { width: 100%; }

/* ==========================================
   4. STATS GRID (NEW LAYOUT)
   ========================================== */
.sla-sheet .stats-grid {
    display: grid;
    /* 3 Main Stat Groups + 1 Secondary Column */
    grid-template-columns: 1fr 1fr 1fr 90px;
    gap: 10px;
    padding: 5px;
    background: rgba(0,0,0,0.1);
    border-bottom: 2px solid var(--sla-bg-panel);
    margin-bottom: 10px;
}

.stat-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

/* Rating Header (Body/Brains/Bravado) */
.rating-block {
    display: flex;
    align-items: center;
    background: #222;
    padding: 2px;
    border: 1px solid #444;
}
.rating-block label {
    flex: 1;
    color: #888;
    font-size: 0.75em;
    font-weight: bold;
    text-align: center;
}
.rating-block input {
    width: 50px;
    text-align: center;
    color: #39ff14 !important; /* Green Text */
    background: #000 !important;
    border: none !important;
    font-weight: bold;
}

/* Stat Rows (STR, DEX, etc) */
.stat-row {
    display: flex;
    align-items: center;
    height: 28px;
    background: #d0d3d8; /* Grey paper look */
    border: 1px solid #555;
}

.stat-row .stat-label {
    width: 50px;
    background: var(--sla-bg-panel);
    color: #fff;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.9em;
}

.stat-row input {
    flex: 1;
    border: none !important;
    background: transparent !important;
    text-align: center;
    font-size: 1.2em;
    font-weight: bold;
    height: 100%;
}

.stat-row .rollable {
    width: 24px;
    text-align: center;
    color: #555;
    cursor: pointer;
}
.stat-row .rollable:hover { color: #000; }

/* Secondary Stats (Right Column) */
.stat-group.secondary {
    justify-content: space-between;
}
.secondary-box {
    background: #445;
    text-align: center;
    padding: 2px;
    border: 1px solid #555;
}
.secondary-box label { display: block; font-size: 0.7em; color: #ccc; }
.secondary-box input { width: 100%; text-align: center; }
.secondary-box.init { background: #334; height: 40px; }
.init-val { font-size: 1.4em; font-weight: bold; color: #fff; margin-right: 5px; }

/* ==========================================
   5. MAIN LAYOUT (LEFT/RIGHT SPLIT)
   ========================================== */
.sla-sheet .main-split {
    display: grid;
    /* 1.6fr = Left Column (Skills/Ebb) - Takes 62% width
       1fr   = Right Column (Vitals)    - Takes 38% width
    */
    grid-template-columns: 1.6fr 1fr; 
    gap: 10px;
    height: 100%;
    overflow: hidden; /* Prevent spillover */
    align-items: start; /* Align tops of columns */
}

/* Ensure columns act as flex containers */
.sla-sheet .left-col, 
.sla-sheet .right-col {
    display: flex;
    flex-direction: column;
    height: 100%;
    min-width: 0; /* Critical for grid children to shrink properly */
}

/* Panels */
.sla-sheet .sla-panel {
    display: flex; flex-direction: column;
    height: 100%; width: 100%;
    background: rgba(0,0,0,0.2);
    border: 1px solid #444;
    overflow: hidden;
}
.sla-sheet .sla-header-bar {
    background-color: var(--sla-bg-panel);
    color: #fff;
    padding: 2px 5px;
    font-weight: bold;
    border-bottom: 1px solid #000;
}
.sla-sheet .scroll-list {
    flex: 1; overflow-y: auto; padding: 0;
}

/* ==========================================
   6. TABS & EDITORS
   ========================================== */
.sla-sheet .sheet-tabs {
    display: flex; border-bottom: 2px solid var(--sla-accent); margin-bottom: 5px; background: #1a1a1a;
}
.sla-sheet .sheet-tabs .item {
    padding: 5px 15px; color: #aaa; font-weight: bold; text-transform: uppercase;
    border-right: 1px solid #333; cursor: pointer;
}
.sla-sheet .sheet-tabs .item:hover { color: #fff; background: rgba(255,255,255,0.05); }
.sla-sheet .sheet-tabs .item.active { color: #000; background: var(--sla-accent); }

.sla-sheet .tab { display: none; height: 100%; overflow-y: auto; }
.sla-sheet .tab.active { display: block; }

/* Editor Containers */
.sla-sheet .editor-container {
    border: 1px solid #444; background: rgba(0, 0, 0, 0.2);
    display: flex; flex-direction: column; position: relative;
}
.sla-sheet .editor-container.appearance,
.sla-sheet .editor-container.biography { flex: 1; min-height: 250px; }
.sla-sheet .editor-container.notes { height: 100%; min-height: 500px; }

.sla-sheet .tab[data-tab="biography"] .editor-container .editor {
    flex: 1; height: 100%; min-height: 0; border: none; background: transparent; padding: 5px;
}
.sla-sheet .tab[data-tab="biography"] .editor-content {
    height: 100%; color: #e0e0e0; font-family: "Arial", sans-serif; line-height: 1.4; overflow-y: auto;
}
.sla-sheet .editor-edit {
    background: #222; color: #39ff14; border: 1px solid #39ff14; padding: 2px 6px;
    border-radius: 4px; position: absolute; top: 5px; right: 5px; z-index: 10;
}

/* ==========================================
   7. LIST ITEMS & DROPS
   ========================================== */
.bio-drop-row { display: flex; align-items: center; margin-bottom: 4px; height: 34px; }
.bio-drop-row label { flex: 0 0 70px; background: #d0d3d8; color: #000; height: 100%; display: flex; align-items: center; padding-left: 5px; font-weight: bold; margin-right: 2px; }
.empty-drop-zone { flex: 1; height: 100%; border: 2px dashed #555; display: flex; align-items: center; justify-content: center; color: #777; }
.item-chip { flex: 1; height: 100%; background: #222; border: 1px solid #39ff14; display: flex; align-items: center; padding: 2px; color: #fff; }
.item-chip img { height: 28px; width: 28px; margin-right: 5px; border: 1px solid #555; }
.item-chip .chip-name { flex: 1; font-weight: bold; color: #39ff14; }
.item-chip .chip-delete { color: #555; padding: 0 8px; cursor: pointer; }
.item-chip .chip-delete:hover { color: #f00; }

/* Item Controls in Lists */
.sla-sheet .item-controls { display: flex; gap: 5px; min-width: 40px; justify-content: center; }
.sla-sheet .item-controls a { width: 18px; text-align: center; color: #aaa; cursor: pointer; }
.sla-sheet .item-controls .item-edit:hover { color: #fff; }
.sla-sheet .item-controls .item-delete:hover { color: #f00; }

/* ==========================================
   8. DIALOGS
   ========================================== */
.sla-dialog .window-content { background: #1a1a1a !important; color: #eee !important; border: 2px solid #444; font-family: "Roboto Condensed"; }
.sla-dialog input, .sla-dialog select { background: #000 !important; color: #fff !important; border: 1px solid #555 !important; }
.sla-dialog h3 { color: #39ff14; border-bottom: 1px solid #555; }
.sla-dialog button { background: #2a2a35; color: #39ff14; border: 1px solid #39ff14; text-transform: uppercase; font-weight: bold; }
.sla-dialog button:hover { background: #39ff14; color: #000; }

/* ==========================================
   11. UI POLISH (ROUNDED & COMPACT)
   ========================================== */

/* The Container Box */
.sla-box {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid #444;
    border-radius: 8px; /* Rounded Corners */
    padding: 5px;
    margin-bottom: 5px;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

/* Header for the box */
.sla-box-header {
    font-size: 0.75em;
    font-weight: bold;
    color: #888;
    text-transform: uppercase;
    border-bottom: 1px solid #333;
    margin-bottom: 3px;
    padding-bottom: 2px;
}

/* Mini Input (2 digits) */
.sla-input-mini {
    width: 40px !important;
    text-align: center;
    border-radius: 4px !important;
    background: #111 !important;
    color: #fff !important;
    border: 1px solid #555 !important;
    height: 22px !important;
    font-weight: bold;
}

/* Standard Input inside box */
.sla-box input[type="text"], 
.sla-box input[type="number"] {
    background: #111;
    color: #fff;
    border: 1px solid #555;
    border-radius: 4px;
}

/* Flex rows for side-by-side stats */
.compact-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9em;
    color: #ccc;
}

/* Update Stat Rows to be rounded */
.stat-row {
    border-radius: 4px;
    overflow: hidden; /* Clips the inner label background */
    border: 1px solid #444;
}
.rating-block {
    border-radius: 4px;
    border: 1px solid #444;
    overflow: hidden;
}
.secondary-box {
    border-radius: 4px;
}

/* ==========================================
   11. UI POLISH (ROUNDED & COMPACT)
   ========================================== */

/* The Container Box */
.sla-box {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid #444;
    border-radius: 8px; /* Rounded Corners */
    padding: 8px;
    margin-bottom: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

/* Header for the box */
.sla-box-header {
    font-size: 0.75em;
    font-weight: bold;
    color: #888;
    text-transform: uppercase;
    border-bottom: 1px solid #333;
    margin-bottom: 5px;
    padding-bottom: 2px;
    letter-spacing: 1px;
}

/* Mini Input (2 digits) */
.sla-input-mini {
    width: 45px !important;
    text-align: center;
    border-radius: 4px !important;
    background: #111 !important;
    color: #fff !important;
    border: 1px solid #555 !important;
    height: 24px !important;
    font-weight: bold;
}

/* Flex rows for side-by-side stats */
.compact-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9em;
    color: #ccc;
    height: 26px;
}

/* ==========================================
   WOUNDS ALIGNMENT
   ========================================== */
.wound-list {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Two Columns */
    gap: 5px 15px;
}

.wound-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255, 255, 255, 0.05);
    padding: 2px 5px;
    border-radius: 4px;
}

.wound-entry label {
    font-size: 0.85em;
    color: #ddd;
    cursor: pointer;
}

.wound-entry input[type="checkbox"] {
    height: 16px;
    width: 16px;
    margin: 0;
    cursor: pointer;
}

/* ==========================================
   CONDITION BUTTONS (ROUNDED SQUARES)
   ========================================== */
.condition-grid {
    display: flex;
    justify-content: space-between;
    gap: 2px;
}

.condition-toggle {
    background: #222;
    border: 1px solid #444;
    width: 36px;
    height: 36px;
    border-radius: 5px; /* Rounded Square */
    display: flex;
    align-items: center;
    justify-content: center;
    color: #555;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 1.3em;
}

.condition-toggle:hover {
    border-color: #fff;
    color: #aaa;
}

/* Active State (The Glow) */
.condition-toggle.active {
    background: #333;
    color: #39ff14; /* SLA Green Default */
    border-color: #39ff14;
    box-shadow: 0 0 8px rgba(57, 255, 20, 0.4);
    text-shadow: 0 0 5px #39ff14;
}

/* Specific Colors for Stunned/Immobile/Etc */
.condition-toggle[data-condition="bleeding"].active { 
    color: #ff4444; border-color: #ff4444; box-shadow: 0 0 8px rgba(255,68,68,0.4); text-shadow: 0 0 5px #ff4444; 
}
.condition-toggle[data-condition="burning"].active { 
    color: #ffaa00; border-color: #ffaa00; box-shadow: 0 0 8px rgba(255,170,0,0.4); text-shadow: 0 0 5px #ffaa00; 
}
.condition-toggle[data-condition="stunned"].active { 
    color: #ffff00; border-color: #ffff00; box-shadow: 0 0 8px rgba(255,255,0,0.4); text-shadow: 0 0 5px #ffff00; 
}
.condition-toggle[data-condition="immobile"].active { 
    color: #00ccff; border-color: #00ccff; box-shadow: 0 0 8px rgba(0,204,255,0.4); text-shadow: 0 0 5px #00ccff; 
}

/* Critical is read-only */
.condition-read-only {
    width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; border-radius: 5px; background: #222; border: 1px solid #444; color: #555;
}
.condition-read-only.active {
    color: #ff0000; border-color: #ff0000; background: #300; animation: pulse 1s infinite;
}

/* ==========================================
   EBB DISCIPLINES STYLING
   ========================================== */

/* Parent Row (The Discipline) */
.discipline-row {
    background-color: rgba(138, 43, 226, 0.15) !important; /* Purple Tint */
    border-bottom: 1px solid #444;
    border-top: 1px solid #444;
}

.discipline-row:hover {
    background-color: rgba(138, 43, 226, 0.25) !important;
}

/* Child Row (The Formula) */
.formula-row {
    background-color: transparent !important;
    border-bottom: 1px dotted #333;
}

.formula-row:hover {
    background-color: rgba(255, 255, 255, 0.05) !important;
}

/* Remove border from the last formula in a group to look cleaner */
.formula-row:last-child {
    border-bottom: none;
}

/* Rollable Hover for Formulas */
.formula-row .rollable:hover {
    color: #fff !important;
    text-shadow: 0 0 5px #8a2be2;
}